# BetterAuth Serverless Template

## Overview
A serverless authentication service pattern using BetterAuth, Express.js, and AWS Lambda with a custom Lambda authorizer for API Gateway.

**Repository**: https://github.com/mdivani/better-auth-serverless

## Stack
- AWS Lambda - Serverless compute
- Express.js - Web framework
- BetterAuth - Authentication library
- Prisma - PostgreSQL ORM
- Serverless Framework v4 - Deployment
- Node.js 22 - Runtime

## Architecture
```
API Gateway → Lambda Authorizer → Lambda Function → Express.js → BetterAuth → PostgreSQL
```

### Custom Lambda Authorizer
The service includes a custom Lambda authorizer that validates JWT tokens from BetterAuth for API Gateway requests. Located at `src/functions/auth/authorizer/handler.ts`.

## API Endpoints (Auto-generated by BetterAuth)
- `POST /auth/signin` - Sign in
- `POST /auth/signup` - Sign up
- `POST /auth/signout` - Sign out
- `GET /auth/session` - Get session
- `POST /auth/verify-email` - Verify email
- `GET /auth/oauth/{provider}` - OAuth flow
- `POST /auth/forgot-password` - Password reset
- `POST /auth/2fa/enable` - Enable 2FA

## Key Configuration Points
- **BetterAuth setup**: `src/lib/auth.ts`
- **Database schema**: `prisma/schema.prisma`
- **Lambda functions**: `src/functions/`
- **Serverless config**: `serverless.ts`

## Commands
```bash
yarn start          # Start development server (localhost:3000/auth/)
yarn deploy         # Deploy to AWS
yarn deploy --stage prod  # Deploy to production
yarn test           # Run tests
yarn migrate:dev    # Run database migrations
```

## Prerequisites
- Node.js 22+
- Yarn 4+ (corepack enable)
- PostgreSQL database
- AWS account

## Why This Pattern
- Reduces operational overhead with serverless
- Scalable authentication out of the box
- Custom Lambda authorizer provides flexible API protection
- BetterAuth is extensible via plugins and hooks
